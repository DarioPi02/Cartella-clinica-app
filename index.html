<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Scheda Degenza Paziente Interattiva</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    
    <style>
        body { font-family: 'Inter', sans-serif; }
        .form-section-title { font-size: 1.5rem; font-weight: 700; color: #2563eb; margin-bottom: 0.5rem; padding-bottom: 0.5rem; border-bottom: 2px solid #e5e7eb; }
        .form-section-subtitle { color: #6b7280; margin-bottom: 1.5rem; }
        .dynamic-input-container input { margin-bottom: 0.5rem; }

        /* Stili per la Stampa */
        @media print {
            body { -webkit-print-color-adjust: exact; print-color-adjust: exact; }
            .no-print { display: none !important; }
            .printable-area { box-shadow: none; border: none; }
            body.print-evaluation-only .form-section:not(#medical-evaluation-section, .patient-info-print-only) { display: none; }
            body.print-evaluation-only .patient-info-print-only { display: block !important; }
            body.print-evaluation-only h1 { display: none; }
            .page-break { page-break-before: always; }
        }
    </style>
</head>
<body class="bg-gray-100 text-gray-800">

    <div class="container mx-auto p-4 sm:p-6 lg:p-8">
        
        <div class="flex justify-between items-center mb-6 no-print">
            <h1 class="text-3xl font-bold text-gray-800">Cartella Clinica</h1>
            <button type="button" id="new-card-btn" class="px-5 py-2 bg-indigo-600 text-white font-semibold rounded-lg hover:bg-indigo-700 transition">
                + Crea Nuova Scheda
            </button>
        </div>

        <div id="form-section" class="printable-area bg-white rounded-xl shadow-lg p-6 sm:p-8 mb-8">
            <div id="patient-info-header-print" class="patient-info-print-only hidden p-4 mb-4 border-b-2 border-black">
                <h1 class="text-xl font-bold" id="print-header-title"></h1>
                <p class="text-sm" id="print-header-date"></p>
            </div>

            <form id="patient-form">
                <div class="form-section">
                    <h2 class="form-section-title">Anagrafica Paziente</h2>
                    <p class="form-section-subtitle">Dati identificativi del paziente e del proprietario.</p>
                    <div class="space-y-6">
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <div><label for="entry-date" class="block text-sm font-medium text-gray-700 mb-1">Data di Ingresso</label><input type="date" id="entry-date" class="w-full px-4 py-2 bg-gray-50 border border-gray-300 rounded-lg"></div>
                            <div><label for="owner-lastname" class="block text-sm font-medium text-gray-700 mb-1">Cognome Proprietario <span class="text-red-500">*</span></label><input type="text" id="owner-lastname" placeholder="Es. Rossi" class="w-full px-4 py-2 bg-gray-50 border border-gray-300 rounded-lg" required></div>
                        </div>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <div><label for="phone" class="block text-sm font-medium text-gray-700 mb-1">Telefono</label><input type="tel" id="phone" placeholder="Es. 3331234567" class="w-full px-4 py-2 bg-gray-50 border border-gray-300 rounded-lg"></div>
                            <div><label for="alt-contact" class="block text-sm font-medium text-gray-700 mb-1">Persona diversa da contattare</label><input type="text" id="alt-contact" placeholder="Nome e telefono" class="w-full px-4 py-2 bg-gray-50 border border-gray-300 rounded-lg"></div>
                        </div>
                        <hr class="my-6 border-t border-gray-200">
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <div><label for="patient-name" class="block text-sm font-medium text-gray-700 mb-1">Nome Paziente <span class="text-red-500">*</span></label><input type="text" id="patient-name" placeholder="Es. Fido" class="w-full px-4 py-2 bg-gray-50 border border-gray-300 rounded-lg" required></div>
                            <div><label for="species" class="block text-sm font-medium text-gray-700 mb-1">Specie</label><input type="text" id="species" placeholder="Es. Cane" class="w-full px-4 py-2 bg-gray-50 border border-gray-300 rounded-lg"></div>
                        </div>
                        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
                            <div><label for="sex" class="block text-sm font-medium text-gray-700 mb-1">Sesso</label><select id="sex" class="w-full px-4 py-2 bg-gray-50 border border-gray-300 rounded-lg"><option>Maschio</option><option>Femmina</option><option>Castrato</option><option>Sterilizzata</option></select></div>
                            <div><label for="age" class="block text-sm font-medium text-gray-700 mb-1">Età</label><input type="text" id="age" placeholder="Es. 2 anni" class="w-full px-4 py-2 bg-gray-50 border border-gray-300 rounded-lg"></div>
                            <div><label for="weight" class="block text-sm font-medium text-gray-700 mb-1">Peso (kg) <span class="text-red-500">*</span></label><input type="number" step="0.1" id="weight" placeholder="Es. 10.5" class="w-full px-4 py-2 bg-gray-50 border border-gray-300 rounded-lg" required></div>
                            <div><label for="microchip" class="block text-sm font-medium text-gray-700 mb-1">Microchip</label><input type="text" id="microchip" placeholder="Numero microchip" class="w-full px-4 py-2 bg-gray-50 border border-gray-300 rounded-lg"></div>
                        </div>
                    </div>
                </div>

                <hr class="my-8 border-t-2 border-dashed border-gray-300 page-break">
                <div class="form-section">
                    <h2 class="form-section-title">Storico Paziente e Anamnesi</h2>
                    <div class="space-y-6">
                        <div><label for="reason-for-hospitalization" class="block text-sm font-medium text-gray-700 mb-1">Motivo di Ricovero</label><textarea id="reason-for-hospitalization" rows="3" class="w-full px-4 py-2 bg-gray-50 border border-gray-300 rounded-lg"></textarea></div>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <div>
                                <label for="vaccinations" class="block text-sm font-medium text-gray-700 mb-1">Vaccinazioni</label>
                                <select id="vaccinations" data-other-container="vaccinations-other-container" class="w-full px-4 py-2 bg-gray-50 border border-gray-300 rounded-lg conditional-select"><option>Regolari</option><option>Irregolari</option><option>Non note</option><option>Nessuna</option><option value="Altro">Altro</option></select>
                                <div id="vaccinations-other-container" class="mt-2 hidden"><label for="vaccinations-other" class="block text-sm font-medium text-gray-700 mb-1">Altro (specificare)</label><input type="text" id="vaccinations-other" class="w-full px-4 py-2 bg-gray-50 border border-gray-300 rounded-lg"></div>
                            </div>
                            <div>
                                <label for="parasite-treatments" class="block text-sm font-medium text-gray-700 mb-1">Antiparassitari</label>
                                <select id="parasite-treatments" data-other-container="parasite-treatments-other-container" class="w-full px-4 py-2 bg-gray-50 border border-gray-300 rounded-lg conditional-select"><option>Regolari</option><option>Irregolari</option><option>Non note</option><option>Nessuna</option><option value="Altro">Altro</option></select>
                                <div id="parasite-treatments-other-container" class="mt-2 hidden"><label for="parasite-treatments-other" class="block text-sm font-medium text-gray-700 mb-1">Altro (specificare)</label><input type="text" id="parasite-treatments-other" class="w-full px-4 py-2 bg-gray-50 border border-gray-300 rounded-lg"></div>
                            </div>
                        </div>
                        <div><label for="previous-pathologies" class="block text-sm font-medium text-gray-700 mb-1">Patologie Pregresse</label><textarea id="previous-pathologies" rows="3" class="w-full px-4 py-2 bg-gray-50 border border-gray-300 rounded-lg"></textarea></div>
                    </div>
                </div>

                <hr class="my-8 border-t-2 border-dashed border-gray-300 page-break">
                <div class="form-section">
                    <h2 class="form-section-title">Esame Clinico Obbiettivo d'Ingresso</h2>
                    <div class="space-y-6">
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <div>
                                <label for="mental-state" class="block text-sm font-medium text-gray-700 mb-1">Stato mentale/Reattività</label>
                                <select id="mental-state" data-other-container="mental-state-other-container" class="w-full px-4 py-2 bg-gray-50 border border-gray-300 rounded-lg conditional-select"><option>Normale</option><option>Depresso</option><option>Optunded</option><option>Stuporoso</option><option>Coma</option><option>Iperestesia</option><option value="Altro">Altro</option></select>
                                <div id="mental-state-other-container" class="mt-2 hidden"><label for="mental-state-other" class="block text-sm font-medium text-gray-700 mb-1">Altro cosa?</label><input type="text" id="mental-state-other" class="w-full px-4 py-2 bg-gray-50 border border-gray-300 rounded-lg"></div>
                            </div>
                            <div>
                                <label for="gait" class="block text-sm font-medium text-gray-700 mb-1">Andatura</label>
                                <select id="gait" data-other-container="gait-other-container" class="w-full px-4 py-2 bg-gray-50 border border-gray-300 rounded-lg conditional-select" data-condition-value="Zoppia"><option>Normale</option><option>Atassia</option><option>Paresi</option><option>Paralisi</option><option value="Zoppia">Zoppia</option></select>
                                <div id="gait-other-container" class="mt-2 hidden"><label for="gait-other" class="block text-sm font-medium text-gray-700 mb-1">Zoppia quale arto?</label><input type="text" id="gait-other" class="w-full px-4 py-2 bg-gray-50 border border-gray-300 rounded-lg"></div>
                            </div>
                        </div>
                        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
                            <div><label for="temperature" class="block text-sm font-medium text-gray-700 mb-1">Temperatura (°C)</label><input type="number" step="0.1" id="temperature" class="w-full px-4 py-2 bg-gray-50 border border-gray-300 rounded-lg"></div>
                            <div><label for="capillary-refill-time" class="block text-sm font-medium text-gray-700 mb-1">Tempo Riempimento Capillare (s)</label><input type="number" step="0.1" id="capillary-refill-time" class="w-full px-4 py-2 bg-gray-50 border border-gray-300 rounded-lg"></div>
                            <div><label for="mucous-membranes" class="block text-sm font-medium text-gray-700 mb-1">Colore Mucose</label><input type="text" id="mucous-membranes" class="w-full px-4 py-2 bg-gray-50 border border-gray-300 rounded-lg"></div>
                            <div><label for="hydration" class="block text-sm font-medium text-gray-700 mb-1">Idratazione</label><select id="hydration" class="w-full px-4 py-2 bg-gray-50 border border-gray-300 rounded-lg"><option>Normale</option><option>Lieve</option><option>Moderata</option><option>Grave</option></select></div>
                        </div>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <div>
                                <label for="lymph-nodes" class="block text-sm font-medium text-gray-700 mb-1">Linfonodi Periferici</label>
                                <select id="lymph-nodes" data-other-container="lymph-nodes-other-container" class="w-full px-4 py-2 bg-gray-50 border border-gray-300 rounded-lg conditional-select" data-condition-value="Aumentati"><option>Normali</option><option value="Aumentati">Aumentati</option></select>
                                <div id="lymph-nodes-other-container" class="mt-2 hidden"><label for="lymph-nodes-other" class="block text-sm font-medium text-gray-700 mb-1">Aumentati quali?</label><input type="text" id="lymph-nodes-other" class="w-full px-4 py-2 bg-gray-50 border border-gray-300 rounded-lg"></div>
                            </div>
                            <div><label for="abdominal-palpation" class="block text-sm font-medium text-gray-700 mb-1">Palpazione Addominale</label><select id="abdominal-palpation" class="w-full px-4 py-2 bg-gray-50 border border-gray-300 rounded-lg"><option>Normale</option><option>Dolente</option><option>Tesa</option><option>Masse/Organomegalia</option></select></div>
                        </div>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <div><label for="cardiac-auscultation" class="block text-sm font-medium text-gray-700 mb-1">Auscultazione Cardiaca</label><select id="cardiac-auscultation" class="w-full px-4 py-2 bg-gray-50 border border-gray-300 rounded-lg"><option>Normale</option><option>Soffio</option><option>Battito doppio</option><option>Battito alternato</option><option>Accelerato</option><option>Bradicardico</option><option>Soffocato</option></select></div>
                            <div><label for="pulmonary-auscultation" class="block text-sm font-medium text-gray-700 mb-1">Auscultazione Polmonare</label><select id="pulmonary-auscultation" class="w-full px-4 py-2 bg-gray-50 border border-gray-300 rounded-lg"><option>Normale</option><option>Ronchi</option><option>Crepitii</option><option>Fischi</option></select></div>
                        </div>
                        <div>
                            <label for="cns" class="block text-sm font-medium text-gray-700 mb-1">Sistema Nervoso Centrale</label>
                            <p class="text-xs text-gray-500 mb-1">(riflessi, reazioni posturali, collaborativo o non collaborativo, sedato)</p>
                            <textarea id="cns" rows="3" class="w-full px-4 py-2 bg-gray-50 border border-gray-300 rounded-lg"></textarea>
                        </div>
                        <div><label for="other-findings" class="block text-sm font-medium text-gray-700 mb-1">Altri Rilievi Significativi</label><textarea id="other-findings" rows="3" class="w-full px-4 py-2 bg-gray-50 border border-gray-300 rounded-lg"></textarea></div>
                    </div>
                </div>

                <hr class="my-8 border-t-2 border-dashed border-gray-300 page-break">
                <div class="form-section">
                    <h2 class="form-section-title">Trattamento in Atto (a casa) e Terapie all'Ingresso</h2>
                    <p class="form-section-subtitle">Trattamenti a casa e terapie segnate al ricovero (non necessariamente da eseguire).</p>
                    <div class="space-y-6">
                        <div><label for="home-treatments" class="block text-sm font-medium text-gray-700 mb-1">Fluidi o farmaci A CASA (dosaggio, via e frequenza)</label><textarea id="home-treatments" rows="3" class="w-full px-4 py-2 bg-gray-50 border border-gray-300 rounded-lg"></textarea></div>
                        <div><label for="admission-therapy" class="block text-sm font-medium text-gray-700 mb-1">Terapia medica ALL'ATTO DEL RICOVERO</label><textarea id="admission-therapy" rows="3" class="w-full px-4 py-2 bg-gray-50 border border-gray-300 rounded-lg"></textarea></div>
                        
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Esami da Eseguire (mettere una spunta)</label>
                            <div class="space-y-3">
                                <div class="flex items-center"><input id="exam-cbc" type="checkbox" class="h-4 w-4 rounded"><label for="exam-cbc" class="ml-2">Emocromo</label></div>
                                <div class="flex items-center">
                                    <input id="exam-biochem" type="checkbox" class="h-4 w-4 rounded conditional-checkbox" data-other-container="exam-biochem-other-container">
                                    <label for="exam-biochem" class="ml-2">Biochimico</label>
                                </div>
                                <div id="exam-biochem-other-container" class="ml-6 hidden">
                                    <label for="exam-biochem-other" class="text-sm">Che tipo di biochimico?</label>
                                    <input type="text" id="exam-biochem-other" class="w-full mt-1 px-2 py-1 bg-gray-50 border rounded-md">
                                </div>
                                <div class="flex items-center">
                                    <input id="exam-snap" type="checkbox" class="h-4 w-4 rounded conditional-checkbox" data-other-container="exam-snap-other-container">
                                    <label for="exam-snap" class="ml-2">Snap Test</label>
                                </div>
                                <div id="exam-snap-other-container" class="ml-6 hidden">
                                    <label for="exam-snap-other" class="text-sm">Quale snap test?</label>
                                    <input type="text" id="exam-snap-other" class="w-full mt-1 px-2 py-1 bg-gray-50 border rounded-md">
                                </div>
                                <div class="flex items-center"><input id="exam-urinalysis" type="checkbox" class="h-4 w-4 rounded"><label for="exam-urinalysis" class="ml-2">Esame Urine (chimico e fisico)</label></div>
                                <div class="flex items-center"><input id="exam-pucu" type="checkbox" class="h-4 w-4 rounded"><label for="exam-pucu" class="ml-2">Pu/Cu</label></div>
                                <div class="flex items-center">
                                    <input id="exam-rx" type="checkbox" class="h-4 w-4 rounded conditional-checkbox" data-other-container="exam-rx-other-container">
                                    <label for="exam-rx" class="ml-2">Rx</label>
                                </div>
                                <div id="exam-rx-other-container" class="ml-6 hidden">
                                    <label for="exam-rx-other" class="text-sm">Quante?</label>
                                    <input type="number" id="exam-rx-other" class="w-full mt-1 px-2 py-1 bg-gray-50 border rounded-md">
                                </div>
                                <div class="flex items-center"><input id="exam-ultrasound" type="checkbox" class="h-4 w-4 rounded"><label for="exam-ultrasound" class="ml-2">Ecografia specialistica</label></div>
                                <div class="flex items-center"><input id="exam-ecofast" type="checkbox" class="h-4 w-4 rounded"><label for="exam-ecofast" class="ml-2">Ecofast</label></div>
                                <div class="flex items-center"><input id="exam-emogas" type="checkbox" class="h-4 w-4 rounded"><label for="exam-emogas" class="ml-2">Emogas</label></div>
                                <div class="flex items-center">
                                    <input id="exam-surgery" type="checkbox" class="h-4 w-4 rounded conditional-checkbox" data-other-container="exam-surgery-other-container">
                                    <label for="exam-surgery" class="ml-2">Chirurgia</label>
                                </div>
                                <div id="exam-surgery-other-container" class="ml-6 hidden">
                                    <label for="exam-surgery-other" class="text-sm">Che intervento?</label>
                                    <input type="text" id="exam-surgery-other" class="w-full mt-1 px-2 py-1 bg-gray-50 border rounded-md">
                                </div>
                                <div class="flex items-center">
                                    <input id="exam-lab" type="checkbox" class="h-4 w-4 rounded conditional-checkbox" data-other-container="exam-lab-other-container">
                                    <label for="exam-lab" class="ml-2">Laboratorio</label>
                                </div>
                                <div id="exam-lab-other-container" class="ml-6 hidden">
                                    <label for="exam-lab-other" class="text-sm">Che richiesta?</label>
                                    <input type="text" id="exam-lab-other" class="w-full mt-1 px-2 py-1 bg-gray-50 border rounded-md">
                                </div>
                                <div class="flex items-center">
                                    <input id="exam-other" type="checkbox" class="h-4 w-4 rounded conditional-checkbox" data-other-container="exam-other-other-container">
                                    <label for="exam-other" class="ml-2">Altro</label>
                                </div>
                                <div id="exam-other-other-container" class="ml-6 hidden">
                                    <label for="exam-other-other" class="text-sm">Altro cosa?</label>
                                    <input type="text" id="exam-other-other" class="w-full mt-1 px-2 py-1 bg-gray-50 border rounded-md">
                                </div>
                            </div>
                        </div>

                        <div class="mt-6 pt-6 border-t border-gray-200">
                            <label class="block text-sm font-medium text-gray-700 mb-2">Esami Effettivamente Eseguiti</label>
                            <div class="space-y-3">
                                <div class="flex items-center"><input id="executed-exam-cbc" type="checkbox" class="h-4 w-4 rounded"><label for="executed-exam-cbc" class="ml-2">Emocromo</label></div>
                                <div>
                                    <div class="flex items-center">
                                        <input id="executed-exam-biochem" type="checkbox" class="h-4 w-4 rounded conditional-checkbox" data-other-container="executed-exam-biochem-other-container">
                                        <label for="executed-exam-biochem" class="ml-2">Biochimico</label>
                                    </div>
                                    <div id="executed-exam-biochem-other-container" class="ml-6 mt-1 hidden">
                                        <label for="executed-exam-biochem-other" class="text-sm">Quale?</label>
                                        <input type="text" id="executed-exam-biochem-other" class="w-full mt-1 px-2 py-1 bg-gray-50 border rounded-md">
                                    </div>
                                </div>
                                <div class="flex items-center"><input id="executed-exam-snap" type="checkbox" class="h-4 w-4 rounded"><label for="executed-exam-snap" class="ml-2">Snap Test</label></div>
                                <div class="flex items-center"><input id="executed-exam-urinalysis" type="checkbox" class="h-4 w-4 rounded"><label for="executed-exam-urinalysis" class="ml-2">Esame Urine (chimico e fisico)</label></div>
                                <div class="flex items-center"><input id="executed-exam-pucu" type="checkbox" class="h-4 w-4 rounded"><label for="executed-exam-pucu" class="ml-2">Pu/Cu</label></div>
                                <div class="flex items-center"><input id="executed-exam-rx" type="checkbox" class="h-4 w-4 rounded"><label for="executed-exam-rx" class="ml-2">Rx</label></div>
                                <div class="flex items-center"><input id="executed-exam-ultrasound" type="checkbox" class="h-4 w-4 rounded"><label for="executed-exam-ultrasound" class="ml-2">Ecografia specialistica</label></div>
                                <div class="flex items-center"><input id="executed-exam-ecofast" type="checkbox" class="h-4 w-4 rounded"><label for="executed-exam-ecofast" class="ml-2">Ecofast</label></div>
                                <div class="flex items-center"><input id="executed-exam-emogas" type="checkbox" class="h-4 w-4 rounded"><label for="executed-exam-emogas" class="ml-2">Emogas</label></div>
                                <div class="flex items-center"><input id="executed-exam-surgery" type="checkbox" class="h-4 w-4 rounded"><label for="executed-exam-surgery" class="ml-2">Chirurgia
